# install required CRAN packages
for (pkg in c("BiocManager", "data.table", "httr", "dendextend", "googledrive")) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    install.packages(pkg)
  }
}

# install required Bioc packages
for (pkg in c("limma", "edgeR", "GO.db", "org.Hs.eg.db","ReactomePA")) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    BiocManager::install(pkg, update = FALSE, ask = FALSE)
  }
}

## RNASeq exploratory data analysis

### Linear transformation using voom

Exploratory data analysis, or EDA, is the first thing a data scientist does when he / she gets his hands on the data. It's the ice-breaker with your data. Understanding the distribution of the features, the variation in different samples, and try to see if there is any issue with quality by identifying outliers.

Normally to perform EDA, we would do some simple unsupervised learning such as clustering or dimension reduction. These methods generally requires the data to be normally distributed. Unfortunately the RNASeq data is NOT normally distributed by nature. Therefore some transformation is required for us to perform such analysis. This is also essential later when we try to apply supervised learning methods to build predictive models.

One of the RNASeq analysis libraries that's becoming more and more popular is [edgeR](https://bioconductor.org/packages/release/bioc/html/edgeR.html). Due to its well-maintenance and documentation, it has become one of the preferable choice for RNASeq exploration and analysis packages. It allows you to perform exploratory data analysis (EDA) and differential expression analysis in one go. Within its [documentation](https://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/edgeRUsersGuide.pdf) it also covers most of the experiment designs that you will likely encounter in real life. 

Here we will demonstrate how to perform voom transformation using the TCGA colon adenocarcinoma (COAD) data set. It contains RNASeq profiling data from colon cancer tumors of 449 patients, among which 41 samples also have RNASeq profiling of adjecent normal tissues.

The raw count data can be downloaded from the [TCGA GDC portal](https://portal.gdc.cancer.gov/). I have downloaded and create a count table which you can downloaded from here:

[coad_tcga_counts.txt](https://drive.google.com/file/d/1tov1hQH16R4lE9VaCD69vMAt8RygMwBd/view?usp=sharing)

You can download the file and put it to a local file path.


We can easily load the count table using the `fread` function from `data.table` package. You'll notice how fast it is compared with loading it using the R native `read.table` function. 

library(data.table)
# change the file path to where you download the count table
DATA <- "data"
count_file_path <- "coad_tcga_counts.txt"
# load the count table, set check.names to FALSE so R doesn't rename your columns!
rc <- data.frame(fread(file.path(DATA, count_file_path)), row.names=1, check.names = FALSE)
dim(rc)
